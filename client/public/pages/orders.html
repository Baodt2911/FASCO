<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../../src/css/output.css" type="text/css" />
    <link rel="stylesheet" href="../../src/css/custom.css" type="text/css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <title>Orders</title>
  </head>
  <script
    src="https://www.paypal.com/sdk/js?client-id=AfgEsGEPOYuIGaEskNS46hxAJ0TMEFK3oiRWGTL04nQuxTkxbuvJr73WjNM94feVbsycamo1Bk0wniZT"
    async
  ></script>
  <body>
    <main>
      <header class="header"></header>
      <!-- Content -->
      <div
        class="py-10 mx-56 border-t border-[#DEDFE1] flex items-start gap-x-32"
      >
        <!-- card left  -->
        <div class="flex flex-col">
          <h2 class="text-xl font-semibold mb-4 font-poppins">Your account</h2>
          <nav class="ml-5">
            <ul class="space-y-2">
              <li>
                <a href="./account.html" class="hover:underline font-poppins"
                  >Personal details</a
                >
              </li>
              <li>
                <a
                  href="./orders.html"
                  class="text-[#FF4646] hover:underline font-poppins"
                  >Orders</a
                >
              </li>
              <li>
                <a href="./address.html" class="hover:underline font-poppins"
                  >Addresses</a
                >
              </li>
              <li>
                <a href="#" class="hover:underline font-poppins">Gift Cards</a>
              </li>
            </ul>
          </nav>
        </div>
        <!-- card right  -->
        <div class="flex-1">
          <h3 class="font-poppins text-4xl font-semibold">Orders</h3>
          <p class="font-poppins mt-2">
            Here are your recent orders and their details.
          </p>
          <!-- Orders List -->
          <section id="orders-list" class="flex-1 mt-10 flex gap-y-10 flex-col">
            <!-- Order Item -->
            <div class="bg-white shadow rounded-lg p-6">
              <!-- Order Header -->
              <div class="flex justify-between items-center border-b pb-4 mb-4">
                <div>
                  <p class="text-gray-700 text-sm">Order ID:</p>
                  <p class="text-lg font-semibold text-gray-800">#12345</p>
                </div>
                <span
                  class="text-sm font-medium px-5 py-2 rounded-full bg-purple-100 text-purple-800"
                >
                  Pending
                </span>
              </div>
              <!-- Product List -->
              <div class="flex flex-col items-center">
                <div
                  id="order-12345"
                  class="w-full max-h-72 overflow-hidden space-y-4"
                >
                  <!-- Product -->
                  <div class="flex items-center justify-between">
                    <img
                      src="https://via.placeholder.com/80"
                      alt="Product Image"
                      class="w-20 h-20 object-cover rounded-md shadow"
                    />
                    <div class="flex-1 ml-4">
                      <p class="font-medium text-gray-800">Smart Watch</p>
                      <p class="text-sm text-gray-600">
                        Color: Silver | Size: XL | Quantity: 1
                      </p>
                      <!-- Rate button -->
                      <button
                        onclick="openModalRating()"
                        class="text-sm text-blue-600 hover:underline"
                      >
                        Rate product
                      </button>
                    </div>
                    <p class="text-gray-800 font-semibold">$150</p>
                  </div>
                </div>
                <!-- View more button  -->
                <button
                  onclick="viewMore(this,'order-12345')"
                  class="btn-view_more size-10 rounded-full shadow bg-white mt-5"
                >
                  <i class="fa-solid fa-chevron-down"></i>
                </button>
              </div>
              <!-- Total and Actions -->
              <div class="border-t pt-4 mt-4 flex justify-between items-center">
                <div>
                  <p class="font-semibold text-gray-800">Total:</p>
                  <p class="text-lg font-bold text-gray-800">$180</p>
                </div>
                <div class="flex space-x-4">
                  <!-- Cancel Button -->
                  <button
                    class="flex items-center space-x-2 px-4 py-2 border rounded-md text-red-600 border-red-600 hover:bg-red-600 hover:text-white"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-5 w-5"
                      viewBox="0 0 20 20"
                      fill="currentColor"
                    >
                      <path
                        fill-rule="evenodd"
                        d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-10.707a1 1 0 00-1.414-1.414L10 8.586 7.707 6.293a1 1 0 10-1.414 1.414L8.586 10l-2.293 2.293a1 1 0 001.414 1.414L10 11.414l2.293 2.293a1 1 0 001.414-1.414L11.414 10l2.293-2.293z"
                        clip-rule="evenodd"
                      />
                    </svg>
                    <span>Cancel</span>
                  </button>
                  <!-- Pay Now Button -->
                  <button
                    class="flex items-center space-x-2 px-4 py-2 border rounded-md text-blue-600 border-blue-600 hover:bg-blue-600 hover:text-white"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-5 w-5"
                      fill="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        d="M12 1a7 7 0 017 7 7 7 0 01-7 7 7 7 0 01-7-7 7 7 0 017-7zm0 2a5 5 0 100 10 5 5 0 000-10zm7 14h-2v1H7v-1H5v5h14v-5zm-3 3H8v-1h8v1z"
                      />
                    </svg>
                    <span>Repayment</span>
                  </button>
                </div>
              </div>
            </div>
          </section>
        </div>
        <!-- Modal confirm cancel  -->
        <div id="cancelModal" class="modal close-modal">
          <div class="bg-white rounded-lg p-6 w-96 shadow-lg">
            <!-- Header -->
            <h1 class="font-semibold text-xl text-gray-800 mb-4 text-center">
              Confirm Order Cancellation
            </h1>
            <p class="text-sm text-gray-600 text-center mb-6">
              Are you sure you want to cancel this order? This action cannot be
              undone.
            </p>
            <!-- Buttons -->
            <div class="flex justify-end space-x-4">
              <button
                onclick="closeModalCancel()"
                class="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200"
              >
                Cancel
              </button>
              <button
                id="btn-confirm-cancel"
                class="px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700"
              >
                Confirm
              </button>
            </div>
          </div>
        </div>

        <!-- Modal payment  -->
        <div id="paymentModal" class="modal close-modal">
          <div class="bg-white rounded-lg p-6 w-96 shadow-lg">
            <h1 class="font-volkhov text-2xl text-[#484848] mb-5">Payment</h1>
            <div id="paypal-button-container"></div>
            <button
              onclick="closeModalPayment()"
              class="float-end px-2 py-1 text-md mt-5 text-red-700 border border-red-300 rounded-md hover:bg-red-200"
            >
              Cancel
            </button>
          </div>
        </div>
        <!-- Modal Structure -->
        <div id="ratingModal" class="modal close-modal">
          <div class="bg-white rounded-lg p-6 w-96 shadow-lg">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">
              Rate Your Product
            </h2>
            <!-- Product Info -->
            <div class="flex items-center mb-4">
              <img
                id="rate-product-image"
                src="https://via.placeholder.com/80"
                alt=""
                class="w-16 h-16 rounded-md object-contain mr-4"
              />
              <span
                id="rate-product-name"
                class="font-poppins text-gray-700"
              ></span>
            </div>
            <!-- Star Rating -->
            <div class="flex mb-4 gap-x-1">
              <span
                class="star text-3xl text-gray-500 cursor-pointer"
                data-value="1"
                >&#9733;</span
              >
              <span
                class="star text-3xl text-gray-500 cursor-pointer"
                data-value="2"
                >&#9733;</span
              >
              <span
                class="star text-3xl text-gray-500 cursor-pointer"
                data-value="3"
                >&#9733;</span
              >
              <span
                class="star text-3xl text-gray-500 cursor-pointer"
                data-value="4"
                >&#9733;</span
              >
              <span
                class="star text-3xl text-gray-500 cursor-pointer"
                data-value="5"
                >&#9733;</span
              >
            </div>

            <!-- Rating Comment -->
            <textarea
              id="reviewText"
              class="w-full p-2 border border-gray-300 rounded-md mb-4"
              rows="4"
              placeholder="Write your review..."
              maxlength="240"
            ></textarea>

            <!-- Action Buttons -->
            <div class="flex justify-end space-x-4">
              <button
                onclick="closeModalRating()"
                class="px-4 py-2 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-200"
              >
                Cancel
              </button>
              <button
                class="btn-submit px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"
              >
                Submit
              </button>
            </div>
          </div>
        </div>
      </div>
      <footer class="footer"></footer>
      <div id="notification"></div>
    </main>
    <script>
      const ratingModal = document.getElementById("ratingModal");
      const paymentModal = document.getElementById("paymentModal");
      const cancelModal = document.getElementById("cancelModal");

      function viewMore(e, orderId) {
        document.getElementById(orderId).classList.toggle("max-h-72");
        if (e.querySelector("i").classList.contains("fa-chevron-down")) {
          e.querySelector("i").classList.remove("fa-chevron-down");
          e.querySelector("i").classList.add("fa-chevron-up");
        } else {
          e.querySelector("i").classList.remove("fa-chevron-up");
          e.querySelector("i").classList.add("fa-chevron-down");
        }
      }

      // Open Modal Rating
      function openModalRating(orderId, _id, idProduct, url, name) {
        ratingModal.classList.remove("close-modal");
        ratingModal
          .querySelector(".btn-submit")
          .setAttribute("data-order_id", orderId);
        ratingModal.querySelector(".btn-submit").setAttribute("data-id", _id);
        ratingModal
          .querySelector(".btn-submit")
          .setAttribute("data-id_product", idProduct);
        ratingModal.querySelector("#rate-product-image").src = url;
        ratingModal.querySelector("#rate-product-name").textContent = name;
      }

      // Close Modal Rating
      function closeModalRating() {
        ratingModal.classList.add("close-modal");
        ratingModal
          .querySelector(".btn-submit")
          .removeAttribute("data-orderId");
        ratingModal.querySelector(".btn-submit").removeAttribute("data-id");
        ratingModal
          .querySelector(".btn-submit")
          .removeAttribute("data-idProduct");
        ratingModal.querySelector("#rate-product-image").src =
          "https://via.placeholder.com/80";
        ratingModal.querySelector("#rate-product-name").textContent = "";
        window.selectedRating = 0;
        document.getElementById("reviewText").value = "";
        document.querySelectorAll(".star").forEach((star) => {
          star.classList.remove("text-yellow-400");
        });
      }
      function openModalPayment() {
        paymentModal.classList.remove("close-modal");
      }
      function closeModalPayment() {
        paymentModal.classList.add("close-modal");
      }
      function openModalCancel(orderId) {
        document
          .getElementById("btn-confirm-cancel")
          .setAttribute("data-order_id", orderId);
        cancelModal.classList.remove("close-modal");
      }
      function closeModalCancel() {
        cancelModal.classList.add("close-modal");
      }
      // Handle Star Selection
      document.querySelectorAll(".star").forEach((star) => {
        star.addEventListener("click", function () {
          const rating = this.getAttribute("data-value");
          document.querySelectorAll(".star").forEach((star) => {
            if (star.getAttribute("data-value") <= rating) {
              star.classList.add("text-yellow-400");
            } else {
              star.classList.remove("text-yellow-400");
            }
          });
          // Store the rating value for submission
          window.selectedRating = rating;
        });
      });
    </script>
  </body>
  <script src="../../src/js/orders.js" type="module"></script>
  <script src="../../src/js/main.js" type="module"></script>
</html>
